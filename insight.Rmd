---
title: "Music Insight"
author: "Cody Evans"
output: html_notebook
---

Importing data

```{r}
suppressMessages(library("tidyverse"))

suppressMessages(surv <- read_csv("https://raw.githubusercontent.com/introdsci/MusicSurvey/master/music-survey.csv"))
suppressMessages(pref <- read_csv("https://raw.githubusercontent.com/introdsci/MusicSurvey/master/preferences-survey.csv"))

N <- nrow(surv)

```

Changing column names for better understanding

```{r}
colnames(surv)[colnames(surv) == "Timestamp"] <- "time_sub"
colnames(pref)[colnames(pref) == "Timestamp"] <- "time_sub"
colnames(surv)[colnames(surv) == "First, we are going to create a pseudonym for you to keep this survey anonymous (more or less). Which pseudonym generator would you prefer?"] <- "generator"
colnames(surv)[colnames(surv) == "What is your pseudonym?"] <- "name"
colnames(pref)[colnames(pref) == "What was your pseudonym?"] <- "name"
colnames(surv)[colnames(surv) == "Sex"] <- "sex"
colnames(surv)[colnames(surv) == "Major"] <- "major"
colnames(surv)[colnames(surv) == "Academic Year"] <- "grade_level"
colnames(surv)[colnames(surv) == "Year you were born (YYYY)"] <- "year_born"
colnames(surv)[colnames(surv) == "Which musical instruments/talents do you play? (Select all that apply)"] <- "instrument"
colnames(surv)[colnames(surv) == "Artist"] <- "song_artist"
colnames(surv)[colnames(surv) == "Song"] <- "song"
colnames(surv)[colnames(surv) == "Link to song (on Youtube or Vimeo)"] <- "link"
colnames(surv)

```

## Making some Tibbles

```{r}
people <- tibble(generator = surv$generator, name = surv$name, sex = surv$sex, major = surv$major, grade_level = surv$grade_level, year_born = surv$year_born, instrument = surv$instrument, time = surv$time_sub)

song_list <- tibble(song_artist = surv$song_artist, song = surv$song, link = surv$link, name = surv$name)

#ratings <- (persName = pref$name, songName = surv$song, rating = #something#)

people$time <- as.POSIXlt(parse_datetime(people$time, format = "%D %H:%M"))

for(n in 1:N) {
  if(identical(x = people$generator[n], y ="Fake rapper name generator")) {   
    people$generator[n] <- "rapper"
  } else {
    people$generator[n] <- "band"
  }
}

## install.packages("pracma")
suppressMessages(library("pracma"))
for(n in 1:N) {
  for(z in 1:N) {
    if(strcmpi(people$major[n], people$major[z])) {
      people$major[z] = people$major[n]
    }
  }
}
detach("package:pracma", unload=TRUE)

people$major <- as.factor(people$major)

levels(people$major)

temp <- gather(tempPref, key = "song_name", value = "rating", -name)

```